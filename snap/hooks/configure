#!/bin/sh -e

mkdir -p "$SNAP_DATA/var/run/bird/"
if [ ! -f "$SNAP_DATA/etc/bird/minivirt.conf" ]; then
  mkdir -p "$SNAP_DATA/etc/bird/"
  cp "$SNAP/etc/bird/minivirt.conf" "$SNAP_DATA/etc/bird/minivirt.conf"
fi

controller_args="$(snapctl get controller.args)"
if [ -z "$controller_args" ]; then
  snapctl set controller.args='-c $SNAP_COMMON'
fi

daemon_args="$(snapctl get daemon.args)"
if [ -z "$daemon_args" ]; then
  snapctl set daemon.args='-c $SNAP_COMMON'
fi

snapctl restart minivirt
